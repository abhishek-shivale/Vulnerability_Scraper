import { CheerioAPI } from "cheerio"
import { getCvssdata } from "../types/utility"

export async function getCvss($:CheerioAPI, selector:string, version:string, v:number){
    const data:getCvssdata = {
        Title: '',
        NIST:{
            Base_score: null,
            Vector: null,
            NIST: null
        },
      CNA:{
        Cna: null,
        Base_score: null,
        Vector: null
      }
    }
    $(selector).each((i, el) => {
      data.Title = `${version} Severity and Vector Strings`,
        // data.NIST.img = $(el).find(".cvssNvdIcon").attr("src") || null,
        data.NIST.Base_score = $(el).find(`[data-testid="vuln-${version}-panel-score"]`).text() || null,
        data.NIST.Vector = $(el).find(`[data-testid="vuln-${version}-nist-vector"]`).text(),
        data.NIST.NIST = $(el).find(`[data-testid="vuln-${version}-source-nvd"]`).text() || null
  
      // data.CNA.img = $(el).find(`#v${v}CnaIconReference .cvssNvdIcon`).attr("src") || null,
        data.CNA.Cna = $(el).find(`[data-testid="vuln-${version}-source-cna"]`).text() || null,
        data.CNA.Base_score = $(el).find(`.severityDetail [data-testid="vuln-${version}-cna-panel-score"]`).text()
  
      data.CNA.Vector = $(el).find(`[data-testid="vuln-${version}-cna-vector"]`).text() || null
  
      })
  return data
  }
  