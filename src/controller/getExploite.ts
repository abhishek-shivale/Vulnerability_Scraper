import { load } from "cheerio";
import { extractDetails } from "../utils/parse";
import { typeVulnerability } from "../types/getExploite";
export const url = "https://nvd.nist.gov"

export async function getExploite(){
    const response = await fetch(url);
    const data = await response.text()
    const latestVulnerability:typeVulnerability[] = []
    let $ = load(data);
    $("#latestVulns li").each((i, el) => {
      let Vulnerability:typeVulnerability = {
        Id: '',
        Details: '',
        Description: null
      }
     Vulnerability.Id = $(el).find("a").text() || null
      Vulnerability.Details = $(el).find("a").attr("href") || null
      Vulnerability.Description = extractDetails($(el).find("p").text()) || null
      latestVulnerability.push(Vulnerability)
    }) || null
    return latestVulnerability
  }
  